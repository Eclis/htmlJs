<script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.js"></script>


<iframe width="100%" height="500" id="meuFrame" src="https://naturabr.sharepoint.com/sites/DEV_LotePiloto/Lists/Agendamentos/Acompanhamento.aspx" ></iframe>

<script type="text/javascript">

function editarLista(){
    var $frame = document.getElementById("meuFrame");
    var $document = $(document.getElementById("meuFrame").contentDocument);
    
    $document.ready(function () {            
        $document.find('button[name=Editar]').click(function () {   
            var id = $document.find('.ms-DetailsRow.is-selected div[data-automation-key="ID"] span').text();
            window.location.href = 'https://naturabr.sharepoint.com/sites/DEV_LotePiloto/SiteAssets/main.aspx?action=edit&loteid='+id;
            return false;   
        });
    });
}

function criarNovo() {
    var $frame = document.getElementById("meuFrame");
    var $document = $(document.getElementById("meuFrame").contentDocument);
    
    $document.ready(function () {            
        $document.find('button[name=Novo]').click(function () {                
            window.location.href = 'https://naturabr.sharepoint.com/sites/DEV_LotePiloto/SiteAssets/main.aspx?action=new';
            return false;   
        });
    });
}


function threadNovo( maxValue){
    var me = this;
    var novoLength = document.getElementById('meuFrame').contentWindow.document.getElementsByName('Novo').length;

    if (novoLength != 0 ){
        if ( novoLength != 1){
            novoLength = 0;
        }
    }

    if (novoLength == 0){
        setTimeout(function () { me.threadNovo( maxValue); }, 500);
    } else {
        criarNovo();
        setTimeout(function () { me.threadNovo( maxValue); }, 500);
    }
}

function threadEditar( maxValue){
    var me = this;
    var editarLength = document.getElementById('meuFrame').contentWindow.document.getElementsByName('Editar').length;

    if (editarLength != 0 ){
        if ( editarLength != 1){
            editarLength = 0;
        }
    }

     if (editarLength == 0){
        setTimeout(function () { me.threadEditar( maxValue); }, 400);
    } else {
        editarLista();
        setTimeout(function () { me.threadEditar( maxValue); }, 400);
    }
}

threadNovo(1);
threadEditar(1);

</script>